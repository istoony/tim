<!DOCTYPE html>
<html lang="it">

<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


<title>Page Title</title>

<!-- Bootstrap: Latest compiled and minified CSS -->
<link rel="stylesheet"	href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
<!-- jQuery library -->
<script	src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<!-- Bootstrap library -->
<script	src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<!-- website Javascript -->
<script src="http://guidoantoniomatteo.altervista.org/tim/js/menu.js"></script>
<script src="http://guidoantoniomatteo.altervista.org/tim/js/template.js"></script>

<!-- website CSS -->
<link rel="stylesheet" type="text/css" href="http://guidoantoniomatteo.altervista.org/tim/css/menu.css">
<link rel="stylesheet" type="text/css" href="http://guidoantoniomatteo.altervista.org/tim/css/style.css">
<link rel="stylesheet" type="text/css" href="http://guidoantoniomatteo.altervista.org/tim/css/standardimport.css">
<link rel="stylesheet" type="text/css" href="http://guidoantoniomatteo.altervista.org/tim/css/innovazione.css">
<link rel="stylesheet" type="text/css" href="http://guidoantoniomatteo.altervista.org/tim/css/guido.css">


    <script>


        var xmlhttp = new XMLHttpRequest();
        var url = "http://guidoantoniomatteo.altervista.org/components/piani/getMainCategoryPiani.php";

        xmlhttp.onreadystatechange=function()
        {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200)
                myFunction(xmlhttp.responseText);
        }
        xmlhttp.open("GET", url, true);
        xmlhttp.send();

        function myFunction(response) {
            var arr = JSON.parse(response);
            var i;
            var out="";
            var idcategoria =1;
            for(i = 0; i < arr.length; i++) {

                if(idcategoria != arr[i].id){
                    alert("categoria:")
                    alert(idcategoria);
                    var offertePiani = new XMLHttpRequest();
                    var piani = "http://guidoantoniomatteo.altervista.org/components/offerte/getOffertePiani.php?id=" + idcategoria;
                    offertePiani.onreadystatechange = function () {
                    if (offertePiani.readyState == 4 && offertePiani.status == 200)
                        getOffertePiani(offertePiani.responseText, idcategoria);
                    }
                    offertePiani.open("GET", piani, true);
                    offertePiani.send();
                    idcategoria=arr[i].id;
                }
                out+='<div class="row father-center marginforrow" style="background-color:#F0F0F0"><div class="col-md-1 child-center nomarginLR nopadding"><h3 class="description-blu text-bold text-center">' + arr[i].nome + '</h3></div><div id=' + idcategoria + ' ></div><div class="col-md-1 child-center"></div></div>';

            }
            document.getElementById("id01").innerHTML = out;
        }





        function getOffertePiani(response, idcategoria) {
            var arr = JSON.parse(response);
            var i;
            var out = "";
            for(i = 0; i < arr.length; i++)  {

                out+= '<div class="col-md-3 nomarginfull promotiontile"><div class="promotionbox1" ><h3 class="description-white text-bold text">' + arr[i].nome + '</h3><p class="description description-white text-lighter">' + arr[i].descrizionepiano + '</p></div><div class="promotionbox2" ></br><h1 class="description-red">' + arr[i].prezzo + '</h1><p class="description description-black">' + arr[i].descrizioneattivazione + '</p></div></div>';
            }
            alert("alert:");
            alert(idcategoria);
            document.getElementById(idcategoria).innerHTML = out;

        }




    </script>
</head>

<body>

	<div id="page" class="container">

		<div id="header"></div>

		<div id="content" class="row">
			<div class="col-xs-12">


				<div class="row marginforrow">
                    <div class="col-md-12 ">

                        <img class=" img-responsive" src="http://guidoantoniomatteo.altervista.org/tim/img/offerte/piani/presentazione.jpg" style="width:100%;" alt="offerte piani tim">
                        <div class="row">
                            <div class="col-md-6 inner-presentation">
                                <div>
                                    <h1 class="text-left">PIANI IN OFFERTA</h1>
                                </div>
                                <div>
                                    <h2 class="text-left">I nostri piani non sono mai stati<br> cos√¨ convenienti.</h2>
                                </div>
                            </div>
                            <div class="col-md-6"></div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div id="id01">
                    </div>
                </div>

			</div>

		</div>

		<div id="footer"></div>

	</div>

</body>

</html>
